{
  "isoflop_k4_baseline": {
    "config": {
      "name": "isoflop_k4_baseline",
      "description": "K=4, 14 layers, 1024 seq (baseline for IsoFLOP comparison)",
      "dim": 512,
      "num_heads": 8,
      "num_layers": 14,
      "num_hyper_nodes": 4,
      "router_temperature": 1.0,
      "router_type": "linear",
      "use_local_rope": true,
      "use_mixed_rope": false,
      "block_pattern": null,
      "num_steps": 100000,
      "batch_size": 1,
      "grad_accum": 16,
      "seq_len": 1024,
      "lr": 0.0003,
      "patience": 5,
      "dataset": "pg19",
      "eval_seq_lens": null,
      "use_rope_freq_exploration": false,
      "rope_freq_range": [
        1.0,
        4.0
      ]
    },
    "ablation_params": {
      "router_type": "linear",
      "use_local_rope": true,
      "use_mixed_rope": false,
      "block_pattern": "SSSSSSSSSSSSSS",
      "num_layers": 14,
      "seq_len": 1024,
      "eval_seq_lens": null
    },
    "gpu_id": 0,
    "steps": [
      500,
      1000,
      1500,
      2000,
      2500,
      3000,
      3500,
      4000,
      4500,
      5000,
      5500,
      6000,
      6500,
      7000,
      7500,
      8000,
      8500,
      9000,
      9500,
      10000,
      10500,
      11000,
      11500,
      12000,
      12500,
      13000,
      13500,
      14000,
      14500,
      15000,
      15500,
      16000,
      16500,
      17000,
      17500,
      18000,
      18500,
      19000,
      19500,
      20000,
      20500,
      21000,
      21500,
      22000,
      22500,
      23000,
      23500,
      24000,
      24500,
      25000,
      25500,
      26000,
      26500,
      27000,
      27500,
      28000,
      28500,
      29000,
      29500,
      30000,
      30500,
      31000,
      31500,
      32000,
      32500,
      33000,
      33500,
      34000,
      34500,
      35000,
      35500,
      36000,
      36500,
      37000,
      37500,
      38000,
      38500,
      39000,
      39500,
      40000,
      40500,
      41000,
      41500,
      42000,
      42500,
      43000,
      43500,
      44000,
      44500,
      45000,
      45500,
      46000,
      46500,
      47000,
      47500,
      48000,
      48500,
      49000,
      49500,
      50000,
      50500,
      51000,
      51500,
      52000,
      52500,
      53000,
      53500,
      54000,
      54500,
      55000,
      55500,
      56000,
      56500,
      57000,
      57500,
      58000,
      58500,
      59000,
      59500,
      60000,
      60500,
      61000,
      61500,
      62000,
      62500,
      63000,
      63500,
      64000,
      64500,
      65000,
      65500,
      66000,
      66500,
      67000,
      67500,
      68000,
      68500,
      69000,
      69500,
      70000,
      70500,
      71000,
      71500,
      72000,
      72500,
      73000,
      73500,
      74000,
      74500,
      75000,
      75500,
      76000,
      76500,
      77000,
      77500,
      78000,
      78500,
      79000,
      79500,
      80000,
      80500,
      81000,
      81500,
      82000,
      82500,
      83000,
      83500,
      84000,
      84500,
      85000,
      85500,
      86000,
      86500,
      87000,
      87500,
      88000,
      88500,
      89000,
      89500,
      90000,
      90500,
      91000,
      91500,
      92000,
      92500,
      93000,
      93500,
      94000,
      94500,
      95000,
      95500,
      96000,
      96500,
      97000,
      97500,
      98000,
      98500,
      99000,
      99500,
      100000
    ],
    "train_loss": [
      7.211975482203067,
      6.096088834047317,
      5.599456693306565,
      5.472289664119482,
      5.220885068453848,
      5.103208736747503,
      4.939394947342574,
      4.8839922718182205,
      4.717395665071905,
      4.7017871992886064,
      4.5723069832026955,
      4.412940339103341,
      4.486200062647462,
      4.434157277196646,
      4.403029795005917,
      4.2539642124027015,
      4.490573812484741,
      4.336230581656098,
      4.214170519664884,
      4.307229381337762,
      4.16722960087657,
      3.8681904066056014,
      3.997758243598044,
      4.132725594863295,
      4.068031178928912,
      4.071254622220993,
      4.036907489031553,
      4.027955108486116,
      4.022790913701058,
      3.9661035192757845,
      4.0659417422711845,
      3.970622966006398,
      3.8908371928855776,
      4.0473354405686255,
      3.9770793167576195,
      3.899820211932063,
      3.9812354431822894,
      3.921277721516788,
      3.8165077117830517,
      3.89084120708704,
      3.8477152256742118,
      3.8489812408164146,
      3.828261580429971,
      3.841602937243879,
      3.7567215671017764,
      3.7199994567930696,
      3.845985957980156,
      3.709198973402381,
      3.7124093144983052,
      3.759138428039849,
      3.542884277023375,
      3.6982689714953305,
      3.7924860995672645,
      3.668772713895887,
      3.7302757573798297,
      3.789087968163192,
      3.7321000493243335,
      3.6101229919716715,
      3.708237746305764,
      3.6034175452664496,
      3.655335391126573,
      3.4324950906932354,
      3.693915504924953,
      3.5510655875355006,
      3.5934791656918823,
      3.6704305459223687,
      3.582522614583373,
      3.5427128565050663,
      3.498801614996046,
      3.6524338388592006,
      3.4945256303809584,
      3.361898125998676,
      3.609107056759298,
      3.6210568698123096,
      3.601470525937155,
      3.31654689187929,
      2.905830167427659,
      3.5880545420646666,
      3.287002503879368,
      3.5953543524928393,
      3.5786575707308947,
      3.4562266241535546,
      3.5983235448896886,
      3.6031237425357103,
      3.504483134500682,
      3.6348879061862824,
      3.561116223808378,
      3.6467741202414037,
      3.5637651488259436,
      3.5141158132888375,
      3.615812217928469,
      3.534221983373165,
      3.497263622034341,
      3.5607318540252746,
      3.5495963128469885,
      3.4270892062038185,
      3.5511336996667087,
      3.5028285288885237,
      3.525654075294733,
      3.3325699809268117,
      3.4883823012188078,
      3.4865942650865764,
      3.5342024989426135,
      3.5178576738908887,
      3.41304313249141,
      3.4411583167240023,
      3.39653172685951,
      3.5323820312023164,
      3.338452145587653,
      3.5275735704824327,
      3.429378449689597,
      3.3759454490244387,
      3.4644632528424264,
      3.356880226701498,
      3.4711971905454995,
      3.469185193672776,
      3.474685810830444,
      3.4603394375741483,
      3.4281680027358234,
      3.4328340719677506,
      3.436195497263223,
      3.4772210312262177,
      3.413434785656631,
      3.3998414281606673,
      3.3538436742275954,
      3.3861835209839044,
      3.428168697681278,
      3.4988624144941567,
      3.3838382986336946,
      3.439071557663381,
      3.3738535745330154,
      3.3632561169415713,
      3.1035336350016296,
      3.4303027041777967,
      3.4218592813760043,
      3.4470513469576836,
      3.410909420855343,
      3.4746268163770435,
      3.4529594619721173,
      3.417288859833032,
      3.262245069447905,
      3.3619513412602244,
      3.355611565049738,
      3.358547281265259,
      3.3829590477272866,
      3.228570688854903,
      3.4178114262372254,
      3.385986102461815,
      3.4694660839661955,
      3.2637935780920087,
      3.349484205242246,
      3.324183057591319,
      3.244295347377658,
      3.3992878331802787,
      3.4744136578701434,
      3.292073022779077,
      3.395156777314842,
      3.332147795278579,
      3.281432042069733,
      3.363554839719087,
      3.319674198716879,
      3.355016802806407,
      3.3785649876110257,
      3.3692861770018934,
      3.348157997643575,
      3.414610293028876,
      3.3925073461309077,
      3.3419858666509388,
      3.362683583099395,
      3.3728039060272277,
      3.36366837824136,
      3.330434377208352,
      3.4094630656056104,
      3.312179318547249,
      3.3123530498966574,
      3.2985160605795683,
      3.379772227566689,
      3.325907226137817,
      3.3331124936752023,
      3.3085727397054434,
      3.2936896050721405,
      3.3497311966978014,
      3.4183576726689933,
      3.3595400631465018,
      3.2733613661713896,
      3.3326122689694166,
      3.323881576256361,
      3.228185661610216,
      3.364774245161563,
      3.260819615941495,
      3.342721506901085,
      3.3306147259026764,
      3.27332979603298,
      3.3327994709424673,
      3.3008417584970595,
      3.2902380972504615,
      3.2645658877938986,
      3.381484664158896,
      3.3935400895252825,
      3.319941942460835
    ],
    "val_loss": [
      5.659868068695069,
      5.224431591033936,
      4.7283462715148925,
      4.72789882183075,
      4.477064599990845,
      4.577048258781433,
      4.303983006477356,
      4.281409397125244,
      4.216640114784241,
      4.198376760482788,
      4.153631815910339,
      4.194762349128723,
      4.098231806755066,
      3.965513916015625,
      4.086670608520508,
      4.002493696212769,
      3.985925097465515,
      3.929567742347717,
      4.100217385292053,
      3.9345393705368044,
      3.9186960887908935,
      3.895698657035828,
      3.8797778034210206,
      3.87142671585083,
      3.905716781616211,
      3.83065815448761,
      3.855574703216553,
      3.853912124633789,
      3.828675808906555,
      3.807003378868103,
      3.8119243717193605,
      3.8002284145355225,
      3.775911431312561,
      3.7664325523376463,
      3.7806129550933836,
      3.7575957012176513,
      3.7432233238220216,
      3.7628289079666137,
      3.7331196784973146,
      3.750236778259277,
      3.73847140789032,
      3.7313267040252684,
      3.7007046508789063,
      3.7229129028320314,
      3.7103524255752562,
      3.705998253822327,
      3.70920024394989,
      3.6924615907669067,
      3.684511423110962,
      3.6885635805130006
    ],
    "total_time": 99836.76742529869,
    "best_val_loss": 3.684511423110962,
    "best_step": 98000,
    "final_step": 100000,
    "early_stopped": false
  },
  "isoflop_k6_wider": {
    "config": {
      "name": "isoflop_k6_wider",
      "description": "K=6, dim=640 (IsoFLOP: more width to match K=4 compute)",
      "dim": 640,
      "num_heads": 8,
      "num_layers": 14,
      "num_hyper_nodes": 6,
      "router_temperature": 1.0,
      "router_type": "linear",
      "use_local_rope": true,
      "use_mixed_rope": false,
      "block_pattern": null,
      "num_steps": 100000,
      "batch_size": 1,
      "grad_accum": 16,
      "seq_len": 1024,
      "lr": 0.0003,
      "patience": 5,
      "dataset": "pg19",
      "eval_seq_lens": null,
      "use_rope_freq_exploration": false,
      "rope_freq_range": [
        1.0,
        4.0
      ]
    },
    "ablation_params": {
      "router_type": "linear",
      "use_local_rope": true,
      "use_mixed_rope": false,
      "block_pattern": "SSSSSSSSSSSSSS",
      "num_layers": 14,
      "seq_len": 1024,
      "eval_seq_lens": null
    },
    "gpu_id": 2,
    "steps": [
      500,
      1000,
      1500,
      2000,
      2500,
      3000,
      3500,
      4000,
      4500,
      5000,
      5500,
      6000,
      6500,
      7000,
      7500,
      8000,
      8500,
      9000,
      9500,
      10000,
      10500,
      11000,
      11500,
      12000,
      12500,
      13000,
      13500,
      14000,
      14500,
      15000,
      15500,
      16000,
      16500,
      17000,
      17500,
      18000,
      18500,
      19000,
      19500,
      20000,
      20500,
      21000,
      21500,
      22000,
      22500,
      23000,
      23500,
      24000,
      24500,
      25000,
      25500,
      26000,
      26500,
      27000,
      27500,
      28000,
      28500,
      29000,
      29500,
      30000,
      30500,
      31000,
      31500,
      32000,
      32500,
      33000,
      33500,
      34000,
      34500,
      35000,
      35500,
      36000,
      36500,
      37000,
      37500,
      38000,
      38500,
      39000,
      39500,
      40000,
      40500,
      41000,
      41500,
      42000,
      42500,
      43000,
      43500,
      44000,
      44500,
      45000,
      45500,
      46000,
      46500,
      47000,
      47500,
      48000,
      48500,
      49000,
      49500,
      50000,
      50500,
      51000,
      51500,
      52000,
      52500,
      53000,
      53500,
      54000,
      54500,
      55000,
      55500,
      56000,
      56500,
      57000,
      57500,
      58000,
      58500,
      59000,
      59500,
      60000,
      60500,
      61000,
      61500,
      62000,
      62500,
      63000,
      63500,
      64000,
      64500,
      65000,
      65500,
      66000,
      66500,
      67000,
      67500,
      68000,
      68500,
      69000,
      69500,
      70000,
      70500,
      71000,
      71500,
      72000,
      72500,
      73000,
      73500,
      74000,
      74500,
      75000,
      75500,
      76000,
      76500,
      77000,
      77500,
      78000,
      78500,
      79000,
      79500,
      80000,
      80500,
      81000,
      81500,
      82000,
      82500,
      83000,
      83500,
      84000,
      84500,
      85000,
      85500,
      86000,
      86500,
      87000,
      87500,
      88000,
      88500,
      89000,
      89500,
      90000,
      90500,
      91000,
      91500,
      92000,
      92500,
      93000,
      93500,
      94000,
      94500,
      95000,
      95500,
      96000,
      96500,
      97000,
      97500,
      98000,
      98500,
      99000,
      99500,
      100000
    ],
    "train_loss": [
      7.070643244177103,
      6.029870284080506,
      5.596103238038719,
      5.504831425115466,
      5.243294728659094,
      5.111020140305161,
      4.961586684897542,
      4.9064207708463075,
      4.767584803469479,
      4.751239649504424,
      4.627711165353656,
      4.470748050525785,
      4.546747647151351,
      4.498317253857851,
      4.465399148344994,
      4.3158046283721925,
      4.552420951008797,
      4.404758020728827,
      4.2857376374155285,
      4.377853151738644,
      4.237558872610331,
      3.9408791634589435,
      4.071346813358367,
      4.204365790769458,
      4.1356281611397865,
      4.1392382694110275,
      4.106293645478785,
      4.095736683279276,
      4.094912641942501,
      4.034229681365192,
      4.133457399398089,
      4.035251636728645,
      3.96189006883651,
      4.116707693621517,
      4.036913050793111,
      3.9730330035090446,
      4.051996041819454,
      3.989623275145888,
      3.887012896567583,
      3.9591177357286216,
      3.913163890950382,
      3.9147620086371897,
      3.8969363386631013,
      3.909468329742551,
      3.8292923123538496,
      3.792711004264653,
      3.920770138092339,
      3.7790907711237667,
      3.7829894721210002,
      3.8307046114653347,
      3.6116874750591816,
      3.767120547235012,
      3.8630996295847,
      3.739318623226136,
      3.7977000697553156,
      3.8610241526067255,
      3.804821152806282,
      3.6848752034679055,
      3.779007751189172,
      3.682104269608855,
      3.7295689312294127,
      3.506173271842301,
      3.76307361330837,
      3.618127906486392,
      3.662488495035097,
      3.7431862010359764,
      3.652736178576946,
      3.608846851829439,
      3.5694337938688694,
      3.724771092116833,
      3.566130436904728,
      3.4278710493966935,
      3.6758260223791,
      3.6860801794454456,
      3.6671772582847626,
      3.3965452382601797,
      2.988018219307065,
      3.6476704064011574,
      3.351316870264709,
      3.659847387794405,
      3.6411830131337046,
      3.516744722954929,
      3.6606063078790902,
      3.664452535606921,
      3.564636416822672,
      3.697807609960437,
      3.621302020188421,
      3.709134212709963,
      3.6229519308805465,
      3.578413421995938,
      3.676099156357348,
      3.591660335280001,
      3.557120413929224,
      3.617360020630062,
      3.6046993618272243,
      3.4832179263159633,
      3.6038458152338864,
      3.559626219712198,
      3.5799899635091426,
      3.384381703108549,
      3.544665134642273,
      3.5429535151831804,
      3.5882901926413178,
      3.571995882421732,
      3.4617789550051095,
      3.4926829020380974,
      3.44554008025676,
      3.5839283438771963,
      3.387783880468458,
      3.5780073617324235,
      3.4815477691069243,
      3.4256639880612494,
      3.517615221373737,
      3.4028259914144874,
      3.5202997785136105,
      3.5174210830628874,
      3.5233119138926265,
      3.5097032018825414,
      3.4774253854751587,
      3.480411744259298,
      3.4843605043366552,
      3.5259876375049353,
      3.459475325874984,
      3.448438154987991,
      3.398767710264772,
      3.4299583450593056,
      3.4728919508978726,
      3.5432276788577437,
      3.4319277900755405,
      3.487632085368037,
      3.4190663754828274,
      3.4089428253285585,
      3.1485916149429976,
      3.4732629563324156,
      3.4658540358133614,
      3.4892762285880745,
      3.456012583911419,
      3.5172144234739244,
      3.4959660589545964,
      3.4602068393826486,
      3.3060900957044215,
      3.404586081147194,
      3.4005258736610413,
      3.3999524363912643,
      3.4236188709512354,
      3.2720239589214324,
      3.4616277975775303,
      3.4283277702219785,
      3.5117314253374934,
      3.3015104255862533,
      3.38901671558246,
      3.3626001534685495,
      3.290073125757277,
      3.4369502941221,
      3.514669759716839,
      3.3300027277618645,
      3.4338649964258074,
      3.3690979420281946,
      3.3166715596728027,
      3.3976150563582777,
      3.358142705004662,
      3.3914362910836937,
      3.4135471798907964,
      3.4064756003748626,
      3.385955758782104,
      3.45100815474987,
      3.429621238976717,
      3.37846764572151,
      3.399201572101563,
      3.4103667068425567,
      3.399119097072631,
      3.3678268068768085,
      3.4484925402142106,
      3.3477280684784056,
      3.3478796103894712,
      3.3332728394307196,
      3.416957250997424,
      3.3624616230987012,
      3.368849907215685,
      3.343815888680518,
      3.3321955144256354,
      3.3835098014958205,
      3.4534558837115763,
      3.3941376974880697,
      3.3115156701281667,
      3.3684076182171703,
      3.343392109927139,
      3.2584455243572594,
      3.398348249711096,
      3.2950050469078125,
      3.3790129636973143,
      3.3633491752259435,
      3.3073127394244075,
      3.365872845031321,
      3.3355738127939403,
      3.325064277425408,
      3.2988879278935492,
      3.416280474167317,
      3.4300560465976595,
      3.3535240540131928
    ],
    "val_loss": [
      5.619045476913453,
      5.298450927734375,
      4.805318689346313,
      4.821372361183166,
      4.5627476024627684,
      4.670943751335144,
      4.383793344497681,
      4.364995284080505,
      4.306289596557617,
      4.278817706108093,
      4.225366115570068,
      4.231148405075073,
      4.17688437461853,
      4.04647307395935,
      4.1737518405914305,
      4.074729342460632,
      4.080318093299866,
      3.997371726036072,
      4.239908332824707,
      4.01070237159729,
      4.0049342966079715,
      3.9761099433898925,
      3.969741659164429,
      3.9276165676116945,
      3.98604323387146,
      3.894359407424927,
      3.9420410346984864,
      3.930135431289673,
      3.9063604879379272,
      3.87462673664093,
      3.8833454179763796,
      3.864346079826355,
      3.8460469818115235,
      3.8381734180450437,
      3.8695269632339477,
      3.826831774711609,
      3.809990572929382,
      3.825167155265808,
      3.8003028631210327,
      3.827080445289612,
      3.8035095882415773,
      3.7789706230163573,
      3.7519899940490724,
      3.786334767341614,
      3.776917734146118,
      3.752596335411072,
      3.7789400815963745,
      3.7374977111816405,
      3.7779632997512818,
      3.7357013177871705
    ],
    "total_time": 99978.98706126213,
    "best_val_loss": 3.7357013177871705,
    "best_step": 100000,
    "final_step": 100000,
    "early_stopped": false
  },
  "isoflop_k6_longer_ctx": {
    "config": {
      "name": "isoflop_k6_longer_ctx",
      "description": "K=6, seq_len=1536 (same tokens/timeline as K=4@1024: 256)",
      "dim": 512,
      "num_heads": 8,
      "num_layers": 14,
      "num_hyper_nodes": 6,
      "router_temperature": 1.0,
      "router_type": "linear",
      "use_local_rope": true,
      "use_mixed_rope": false,
      "block_pattern": null,
      "num_steps": 100000,
      "batch_size": 1,
      "grad_accum": 16,
      "seq_len": 1536,
      "lr": 0.0003,
      "patience": 5,
      "dataset": "pg19",
      "eval_seq_lens": null,
      "use_rope_freq_exploration": false,
      "rope_freq_range": [
        1.0,
        4.0
      ]
    },
    "ablation_params": {
      "router_type": "linear",
      "use_local_rope": true,
      "use_mixed_rope": false,
      "block_pattern": "SSSSSSSSSSSSSS",
      "num_layers": 14,
      "seq_len": 1536,
      "eval_seq_lens": null
    },
    "gpu_id": 3,
    "steps": [
      500,
      1000,
      1500,
      2000,
      2500,
      3000,
      3500,
      4000,
      4500,
      5000,
      5500,
      6000,
      6500,
      7000,
      7500,
      8000,
      8500,
      9000,
      9500,
      10000,
      10500,
      11000,
      11500,
      12000,
      12500,
      13000,
      13500,
      14000,
      14500,
      15000,
      15500,
      16000,
      16500,
      17000,
      17500,
      18000,
      18500,
      19000,
      19500,
      20000,
      20500,
      21000,
      21500,
      22000,
      22500,
      23000,
      23500,
      24000,
      24500,
      25000,
      25500,
      26000,
      26500,
      27000,
      27500,
      28000,
      28500,
      29000,
      29500,
      30000,
      30500,
      31000,
      31500,
      32000,
      32500,
      33000,
      33500,
      34000,
      34500,
      35000,
      35500,
      36000,
      36500,
      37000,
      37500,
      38000,
      38500,
      39000,
      39500,
      40000,
      40500,
      41000,
      41500,
      42000,
      42500,
      43000,
      43500,
      44000,
      44500,
      45000,
      45500,
      46000,
      46500,
      47000,
      47500,
      48000,
      48500,
      49000,
      49500,
      50000,
      50500,
      51000,
      51500,
      52000,
      52500,
      53000,
      53500,
      54000,
      54500,
      55000,
      55500,
      56000,
      56500,
      57000,
      57500,
      58000,
      58500,
      59000,
      59500,
      60000,
      60500,
      61000,
      61500,
      62000,
      62500,
      63000,
      63500,
      64000,
      64500,
      65000,
      65500,
      66000,
      66500,
      67000,
      67500,
      68000,
      68500,
      69000,
      69500,
      70000,
      70500,
      71000,
      71500,
      72000,
      72500,
      73000,
      73500,
      74000,
      74500,
      75000,
      75500,
      76000,
      76500,
      77000,
      77500,
      78000,
      78500,
      79000,
      79500,
      80000,
      80500,
      81000,
      81500,
      82000,
      82500,
      83000,
      83500,
      84000,
      84500,
      85000,
      85500,
      86000,
      86500,
      87000,
      87500,
      88000,
      88500,
      89000,
      89500,
      90000,
      90500,
      91000,
      91500,
      92000,
      92500,
      93000,
      93500,
      94000,
      94500,
      95000,
      95500,
      96000,
      96500,
      97000,
      97500,
      98000,
      98500,
      99000,
      99500,
      100000
    ],
    "train_loss": [
      7.357271640494466,
      6.070855928078294,
      5.7297551320642235,
      5.535797912225127,
      5.35751945066452,
      5.148367499403656,
      5.0555791670978065,
      4.806821815006435,
      4.801290614202618,
      4.754765204697847,
      4.684678431078791,
      4.6601109392941,
      4.522179130747914,
      4.534291533380747,
      4.178916089236736,
      4.4183160475716,
      4.3693359019681814,
      4.309684146590531,
      4.298466130703687,
      4.263612936154008,
      4.331370451539755,
      4.144304141096771,
      4.289949268423021,
      4.182220250487328,
      4.2322086512222885,
      4.103523932665587,
      4.17772165966034,
      4.0929732003584505,
      4.0731725757569075,
      4.032077319569885,
      4.0105849305987356,
      4.010343446075916,
      3.9831789844110608,
      3.8646086159050466,
      3.989547016274184,
      3.9557780046984554,
      3.9922347071021793,
      3.9928810757920146,
      3.8789860810562966,
      3.9082617975771425,
      3.923929479625076,
      3.7648000014349816,
      3.762755347918719,
      3.925833412475884,
      3.851544376939535,
      3.715782196946442,
      3.8792696525752546,
      3.6244528982192277,
      3.830019965928048,
      3.853603344641626,
      3.4323921246603133,
      3.673695424482226,
      3.598972375839949,
      3.8348767799139023,
      3.740870370067656,
      3.8094165633320807,
      3.7604910341724755,
      3.8208048576191067,
      3.8233532196730375,
      3.7921272281706333,
      3.819038714416325,
      3.724378939025104,
      3.7684804917499424,
      3.689088819004595,
      3.7682580391615628,
      3.7188139429613947,
      3.564084977835417,
      3.7396609592437744,
      3.760883015088737,
      3.640946327611804,
      3.5787759584635497,
      3.732845644451678,
      3.621923895768821,
      3.650490217320621,
      3.625519088700414,
      3.5799557727947833,
      3.682336669266224,
      3.6662730331644418,
      3.6387139633372425,
      3.6318011772334575,
      3.6540763610377907,
      3.6217657232359053,
      3.565703292950988,
      3.5759678621441124,
      3.6359858581274747,
      3.603935125142336,
      3.6308077549636364,
      3.5323588185012342,
      3.396119454868138,
      3.6049239203743637,
      3.615913476586342,
      3.631340176284313,
      3.623193608619273,
      3.4826020355671643,
      3.531508444495499,
      3.550908153727651,
      3.501313676558435,
      3.5372685191072524,
      3.585738222748041,
      3.506184196576476,
      3.537268935609609,
      3.415262452185154,
      3.614842735685408,
      3.492939756233245,
      3.5640326359160244,
      3.42905969081074,
      3.505088660854846,
      3.505180150579661,
      3.5175195590369404,
      3.521190694924444,
      3.5549902381300926,
      3.5185890997946263,
      3.529308017104864,
      3.496115076839924,
      3.502494340442121,
      3.4950576192885636,
      3.435645239084959,
      3.509659749031067,
      3.4809557712338863,
      3.443112820237875,
      3.4679843607097864,
      3.515753717944026,
      3.487720969170332,
      3.423926621682942,
      3.342947781595751,
      3.449299081273377,
      3.447248381130397,
      3.4445487208478154,
      3.42856608790718,
      3.432114269025624,
      3.3924756218120455,
      3.4817452651783825,
      3.508229664631188,
      3.361707015231252,
      3.4382884086221455,
      3.431472078319639,
      3.477039104707539,
      3.375850666191429,
      3.5163385343924163,
      3.3743456974625587,
      3.4034138299040495,
      3.444609071098268,
      3.4254155290871857,
      3.162301032438874,
      3.517642398186028,
      3.358493335109204,
      3.4312656088098885,
      3.501363713376224,
      3.319649162683636,
      3.4835346955135464,
      3.3691963274106382,
      3.3282125994712115,
      3.4113614839427173,
      3.3520966556072236,
      3.4680617830529807,
      3.3908644287250937,
      3.3492973778843877,
      3.3835624056123197,
      3.414485721681267,
      3.3964919061288237,
      3.3089998685494066,
      3.311686662912369,
      3.3949062032289805,
      3.3517318369522693,
      3.304033791664988,
      3.4396211555190384,
      3.3419795453585683,
      3.283399949423969,
      3.3506794978640975,
      3.297696826737374,
      2.2866000046301633,
      3.3833856854513287,
      3.2939706205315886,
      3.3115276146642865,
      3.3894766907058655,
      3.365798269599676,
      3.320554010435939,
      3.297914774753153,
      3.2107475334545597,
      3.2714708191528916,
      3.30463988731429,
      3.3623108632415533,
      3.370102361571044,
      3.3375465153455735,
      3.3808611815720795,
      3.326082988422364,
      3.2945509361624716,
      3.3563408775776624,
      3.3075866967774927,
      3.40301488250494,
      3.349378247264773,
      3.217588261488825,
      3.292481768961996,
      3.3573881765007973,
      3.266968817777932,
      3.2971668348331002,
      3.278681895785034,
      3.3025242148041727,
      3.3291234123930336,
      3.303061985168606
    ],
    "val_loss": [
      5.723067798614502,
      4.9669629049301145,
      4.74689754486084,
      4.788751544952393,
      4.4821317100524904,
      4.437752847671509,
      4.37133107662201,
      4.318513417243958,
      4.266259603500366,
      4.27498948097229,
      4.183434453010559,
      4.136946082115173,
      4.155534019470215,
      4.116277050971985,
      4.109958901405334,
      4.08570734500885,
      4.115163145065307,
      4.070997653007507,
      4.073275938034057,
      4.009965767860413,
      4.034113812446594,
      3.99020610332489,
      3.969237656593323,
      3.9861106634140016,
      4.016252307891846,
      3.9922657680511473,
      3.958697810173035,
      3.958553557395935,
      3.945194025039673,
      3.9565151929855347,
      4.008921966552735,
      3.914774169921875,
      3.924009084701538,
      3.93280770778656,
      3.934751048088074,
      3.9325100135803224,
      3.856359906196594,
      3.866427154541016,
      3.8836270475387575,
      3.8739044761657713,
      3.849474000930786,
      3.837258930206299,
      3.868737983703613,
      3.8436798286437988,
      3.8882409811019896,
      3.831267237663269,
      3.8216977977752684,
      3.816710124015808,
      3.834987587928772,
      3.8533171939849855
    ],
    "total_time": 105649.04810762405,
    "best_val_loss": 3.816710124015808,
    "best_step": 96000,
    "final_step": 100000,
    "early_stopped": false
  },
  "isoflop_k6_deeper": {
    "config": {
      "name": "isoflop_k6_deeper",
      "description": "K=6, 21 layers (IsoFLOP: more depth to match K=4 compute)",
      "dim": 512,
      "num_heads": 8,
      "num_layers": 21,
      "num_hyper_nodes": 6,
      "router_temperature": 1.0,
      "router_type": "linear",
      "use_local_rope": true,
      "use_mixed_rope": false,
      "block_pattern": null,
      "num_steps": 100000,
      "batch_size": 1,
      "grad_accum": 16,
      "seq_len": 1024,
      "lr": 0.0003,
      "patience": 5,
      "dataset": "pg19",
      "eval_seq_lens": null,
      "use_rope_freq_exploration": false,
      "rope_freq_range": [
        1.0,
        4.0
      ]
    },
    "ablation_params": {
      "router_type": "linear",
      "use_local_rope": true,
      "use_mixed_rope": false,
      "block_pattern": "SSSSSSSSSSSSSSSSSSSSS",
      "num_layers": 21,
      "seq_len": 1024,
      "eval_seq_lens": null
    },
    "gpu_id": 1,
    "steps": [
      500,
      1000,
      1500,
      2000,
      2500,
      3000,
      3500,
      4000,
      4500,
      5000,
      5500,
      6000,
      6500,
      7000,
      7500,
      8000,
      8500,
      9000,
      9500,
      10000,
      10500,
      11000,
      11500,
      12000,
      12500,
      13000,
      13500,
      14000,
      14500,
      15000,
      15500,
      16000,
      16500,
      17000,
      17500,
      18000,
      18500,
      19000,
      19500,
      20000,
      20500,
      21000,
      21500,
      22000,
      22500,
      23000,
      23500,
      24000,
      24500,
      25000,
      25500,
      26000,
      26500,
      27000,
      27500,
      28000,
      28500,
      29000,
      29500,
      30000,
      30500,
      31000,
      31500,
      32000,
      32500,
      33000,
      33500,
      34000,
      34500,
      35000,
      35500,
      36000,
      36500,
      37000,
      37500,
      38000,
      38500,
      39000,
      39500,
      40000,
      40500,
      41000,
      41500,
      42000,
      42500,
      43000,
      43500,
      44000,
      44500,
      45000,
      45500,
      46000,
      46500,
      47000,
      47500,
      48000,
      48500,
      49000,
      49500,
      50000,
      50500,
      51000,
      51500,
      52000,
      52500,
      53000,
      53500,
      54000,
      54500,
      55000,
      55500,
      56000,
      56500,
      57000,
      57500,
      58000,
      58500,
      59000,
      59500,
      60000,
      60500,
      61000,
      61500,
      62000,
      62500,
      63000,
      63500,
      64000,
      64500,
      65000,
      65500,
      66000,
      66500,
      67000,
      67500,
      68000,
      68500,
      69000,
      69500,
      70000,
      70500,
      71000,
      71500,
      72000,
      72500,
      73000,
      73500,
      74000,
      74500,
      75000,
      75500,
      76000,
      76500,
      77000,
      77500,
      78000,
      78500,
      79000,
      79500,
      80000,
      80500,
      81000,
      81500,
      82000,
      82500,
      83000,
      83500,
      84000,
      84500,
      85000,
      85500,
      86000,
      86500,
      87000,
      87500,
      88000,
      88500,
      89000,
      89500,
      90000,
      90500,
      91000,
      91500,
      92000,
      92500,
      93000,
      93500,
      94000,
      94500,
      95000,
      95500,
      96000,
      96500,
      97000,
      97500,
      98000,
      98500,
      99000,
      99500,
      100000
    ],
    "train_loss": [
      7.225089961461723,
      6.1367137327045205,
      5.666694193266332,
      5.5745103809833525,
      5.33071537975967,
      5.212739920333028,
      5.0474890327826145,
      4.9911423290222885,
      4.835653236523271,
      4.817554725766182,
      4.682228284694254,
      4.52241137829423,
      4.5830361219495535,
      4.53479027941823,
      4.493802978038788,
      4.33955217795074,
      4.579978191897273,
      4.424916462793946,
      4.301834334984422,
      4.395129427760839,
      4.250875873208046,
      3.959237661853433,
      4.08451851002872,
      4.21572646805644,
      4.148864523597061,
      4.150081918105483,
      4.1158324705064295,
      4.104229328513146,
      4.101216535292566,
      4.040698461927474,
      4.138894304484129,
      4.042493435323238,
      3.9673373232781888,
      4.123254326932132,
      4.044820814602077,
      3.9780691964179278,
      4.056652591824531,
      3.9980452713817356,
      3.8937495626583694,
      3.965537678360939,
      3.924587807826698,
      3.9218216150477527,
      3.901336133465171,
      3.9133852120935915,
      3.8317570870891213,
      3.8013570487499235,
      3.927051432915032,
      3.783796905875206,
      3.7930934586450458,
      3.8379238824397324,
      3.616440597169101,
      3.7709932679198683,
      3.8683449282161892,
      3.748286955464631,
      3.801058968871832,
      3.865534407135099,
      3.8098072313293816,
      3.6909632778912784,
      3.783127485178411,
      3.689979010589421,
      3.736181602761149,
      3.514546971566975,
      3.768048918798566,
      3.6190203004702926,
      3.6659280567448587,
      3.748456649709493,
      3.660095205500722,
      3.6111593813486396,
      3.5737390577569603,
      3.732068283498287,
      3.5722019069716335,
      3.4345694310441615,
      3.6807942580766975,
      3.6893329134210946,
      3.671201003525406,
      3.425838569134474,
      3.0254684971868993,
      3.652885931916535,
      3.3613043029755354,
      3.6638675926364956,
      3.643251305676997,
      3.5208457349911333,
      3.661121167935431,
      3.6637728820964695,
      3.5675645516738297,
      3.7018552780672906,
      3.625792954899371,
      3.711723052255809,
      3.624415152132511,
      3.589990296792239,
      3.677341105312109,
      3.5948942720368504,
      3.5603868320435286,
      3.621061227455735,
      3.608365159831941,
      3.4849687761738894,
      3.6045242246091367,
      3.5629882263988257,
      3.582798427775502,
      3.3877446324676277,
      3.5490526210740208,
      3.5464650720320643,
      3.5929066867083312,
      3.574588829182088,
      3.4657669861093163,
      3.495545794799924,
      3.448017602678388,
      3.5849980938881636,
      3.391219449080527,
      3.5811332738101482,
      3.483734073523432,
      3.4285997846797107,
      3.5213657589480283,
      3.403651906657964,
      3.5219612229764463,
      3.5174998473599555,
      3.5256091738939284,
      3.5118642886579035,
      3.4794246607609094,
      3.4811581694111227,
      3.487288606081158,
      3.5263613471314312,
      3.459160101763904,
      3.4509313742667436,
      3.399045966181904,
      3.431270704034716,
      3.472189776800573,
      3.5424908136874436,
      3.4322491889707742,
      3.488803054153919,
      3.4185494622550903,
      3.4098393428772686,
      3.1522458028048277,
      3.471816594593227,
      3.4655947084911167,
      3.4896040170639755,
      3.454594002395868,
      3.5159853027313948,
      3.4951407379060986,
      3.4611717222332956,
      3.304906127039343,
      3.405165551196784,
      3.4051546917371454,
      3.39930868781358,
      3.422984569694847,
      3.27288969732821,
      3.461094044968486,
      3.4293559246733785,
      3.514215415965766,
      3.3035679882317783,
      3.3917580787055193,
      3.3601828662380577,
      3.296038515008986,
      3.437860755480826,
      3.5141206216961147,
      3.330964358046651,
      3.433213099453598,
      3.370057490289211,
      3.3175921083167195,
      3.398954297054559,
      3.359876727949828,
      3.392077770382166,
      3.4139613514672966,
      3.4090522971339525,
      3.3857396021913737,
      3.4499290460068734,
      3.4294172573313118,
      3.3774800057634713,
      3.3995149034895005,
      3.409226978980005,
      3.4018743709549306,
      3.366801100291312,
      3.448776347126812,
      3.3464044424071906,
      3.3472108130156992,
      3.3339627886787055,
      3.419714723937213,
      3.366612127676606,
      3.367822012230754,
      3.342412151038647,
      3.3325622175298633,
      3.383544127099216,
      3.452232236497104,
      3.393762515489012,
      3.313392717525363,
      3.3693583103492855,
      3.362689046230051,
      3.2591267988830803,
      3.397602720707655,
      3.294914792455733,
      3.379178523339331,
      3.361662875905633,
      3.305759236553684,
      3.363288348440081,
      3.334113004632294,
      3.3258762539885938,
      3.2977985652610657,
      3.418138789340854,
      3.432679040186107,
      3.3516160534247756
    ],
    "val_loss": [
      5.727010793685913,
      5.392997980117798,
      4.86165668964386,
      4.868965787887573,
      4.571961698532104,
      4.72177303314209,
      4.390692830085754,
      4.369482126235962,
      4.306356844902038,
      4.278116588592529,
      4.232825827598572,
      4.2332702732086185,
      4.189328584671021,
      4.043574619293213,
      4.163516941070557,
      4.077803993225098,
      4.070799951553345,
      4.006305179595947,
      4.222314729690551,
      3.9999278450012206,
      4.018324451446533,
      3.981940412521362,
      3.9499749755859375,
      3.9381832122802733,
      3.971329574584961,
      3.9156444454193116,
      3.956767463684082,
      3.9548904371261595,
      3.9198593854904176,
      3.909763979911804,
      3.9191875505447387,
      3.8892271947860717,
      3.8734370613098146,
      3.85664665222168,
      3.8674525356292726,
      3.827817449569702,
      3.814334678649902,
      3.8304699897766112,
      3.808942880630493,
      3.833613224029541,
      3.823095369338989,
      3.7970777797698974,
      3.7719251823425295,
      3.7926290607452393,
      3.789965534210205,
      3.77473792552948,
      3.7939400911331176,
      3.754632005691528,
      3.752310528755188,
      3.7547037839889525
    ],
    "total_time": 143927.87692666054,
    "best_val_loss": 3.752310528755188,
    "best_step": 98000,
    "final_step": 100000,
    "early_stopped": false
  }
}